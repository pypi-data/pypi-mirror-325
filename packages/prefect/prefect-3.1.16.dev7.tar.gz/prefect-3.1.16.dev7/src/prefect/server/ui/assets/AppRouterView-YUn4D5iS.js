import{d as D,K as I,ae as S,S as O,j as c,o as _,c as v,i as o,n as M,k as t,A as h,q as T,a as y,l as e,t as R,dh as z,di as W,P as j,f as x,cS as q,dj as K,bk as i,dk as l,D as L,dl as Q,dm as H,e as Y,dn as Z,dp as G,I as X,c8 as A,bw as ee,ax as te,aS as C,aL as E,dq as oe,dr as ne,ds as se,r as ae,dt as le,du as ie,dv as re,dw as ue,dx as ce}from"./index-qaIncb5u.js";import{u as me,c as pe}from"./useCan-CQhVMsH7.js";import{U as de,u as fe,c as _e,p as ve}from"./api-CXfC_4VD.js";import"./mapper-BE3CecBu.js";const ke={class:"flex gap-x-2 items-center"},ge={key:0,class:"text-sm italic"},we="http://prefect.io/slack?utm_source=oss&utm_medium=oss&utm_campaign=oss_popup&utm_term=none&utm_content=none",V="join-the-community-modal",be="https://getform.io/f/eapderva",he=D({__name:"JoinTheCommunityModal",props:{showModal:{type:Boolean},showModalModifiers:{}},emits:["update:showModal"],setup(a){const s=I(a,"showModal"),u=S(!1),r=S(),{validate:g,state:m}=O(r,[z("Email"),W("Email")]),k=S(!1),d=S("");async function f(){if(await g()){d.value="",k.value=!0;try{await fetch(be,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.value}),redirect:"manual"}),s.value=!1,j("Successfully subscribed","success")}catch(w){d.value="An error occurred. Please try again.",console.error(w)}finally{k.value=!1}}}return(w,n)=>{const p=c("p-button"),P=c("p-divider"),U=c("p-text-input"),$=c("p-label"),J=c("p-form"),B=c("p-message"),F=c("p-modal");return _(),v(F,{"show-modal":s.value,"onUpdate:showModal":n[2]||(n[2]=b=>s.value=b),title:"Join the Prefect Community"},{header:o(()=>n[3]||(n[3]=[M("h2",null,"Join the Community",-1)])),default:o(()=>[n[5]||(n[5]=M("p",null," Connect with 25k+ engineers scaling Python with Prefect. Show us your work and be the first to know about new Prefect features. ",-1)),M("div",ke,[t(p,{primary:"",icon:"Slack",to:we,target:"_blank",onClick:n[0]||(n[0]=b=>u.value=!0)},{default:o(()=>n[4]||(n[4]=[h(" Join us on Slack ")])),_:1}),u.value?(_(),T("span",ge," Thanks for joining our community! ")):y("",!0)]),t(P,{class:"-my-3"}),t(J,{id:V,onSubmit:f},{default:o(()=>[t($,{label:"Notify me about Prefect updates",state:e(m),message:e(m).error},{default:o(({id:b})=>[t(U,{id:b,modelValue:r.value,"onUpdate:modelValue":n[1]||(n[1]=N=>r.value=N),placeholder:"hello@prefect.io",state:e(m)},null,8,["id","modelValue","state"])]),_:1},8,["state","message"])]),_:1}),d.value?(_(),v(B,{key:0,error:""},{default:o(()=>[h(R(d.value),1)]),_:1})):y("",!0)]),cancel:o(b=>[t(p,{class:"sm:order-first",onClick:b.close},{default:o(()=>n[6]||(n[6]=[h(" Skip ")])),_:2},1032,["onClick"])]),actions:o(()=>[t(p,{primary:"",type:"submit",form:V,loading:k.value},{default:o(()=>n[7]||(n[7]=[h(" Sign up ")])),_:1},8,["loading"])]),_:1},8,["show-modal"])}}}),ye={href:"https://www.prefect.io/cloud-vs-oss?utm_source=oss&utm_medium=oss&utm_campaign=oss&utm_term=none&utm_content=none",target:"_blank"},Ce=D({__name:"ContextSidebar",setup(a){const s=me(),u=x(()=>s.read.work_pool),{showModal:r,open:g}=q(),{value:m}=K("local","join-the-community-modal-dismissed",!1);function k(d){r.value=d,d||(m.value=!0)}return(d,f)=>{const w=c("p-icon"),n=c("router-link"),p=c("p-button");return _(),v(e(Q),{class:"context-sidebar"},{header:o(()=>[t(n,{to:e(i).root(),class:"context-sidebar__logo-link"},{default:o(()=>[t(w,{icon:"Prefect",class:"context-sidebar__logo-icon"})]),_:1},8,["to"])]),footer:o(()=>[M("a",ye,[t(e(l),null,{default:o(()=>[f[1]||(f[1]=M("div",null," Ready to scale? ",-1)),t(p,{primary:"",small:"",class:"context-sidebar__upgade-button"},{default:o(()=>f[0]||(f[0]=[h(" Upgrade ")])),_:1})]),_:1})]),t(e(l),{onClick:e(g)},{default:o(()=>[f[2]||(f[2]=h(" Join the Community ")),t(he,{"show-modal":e(r)||!e(m),"onUpdate:showModal":k},null,8,["show-modal"])]),_:1},8,["onClick"]),t(e(l),{title:"Settings",to:e(i).settings()},null,8,["to"])]),default:o(()=>[t(e(l),{title:"Dashboard",to:e(i).dashboard()},null,8,["to"]),t(e(l),{title:"Runs",to:e(i).runs()},null,8,["to"]),t(e(l),{title:"Flows",to:e(i).flows()},null,8,["to"]),t(e(l),{title:"Deployments",to:e(i).deployments()},null,8,["to"]),u.value?(_(),v(e(l),{key:0,title:"Work Pools",to:e(i).workPools()},null,8,["to"])):y("",!0),u.value?y("",!0):(_(),v(e(l),{key:1,title:"Work Queues",to:e(i).workQueues()},null,8,["to"])),t(e(l),{title:"Blocks",to:e(i).blocks()},null,8,["to"]),t(e(l),{title:e(L).info.variables,to:e(i).variables()},null,8,["title","to"]),t(e(l),{title:"Automations",to:e(i).automations()},null,8,["to"]),t(e(l),{title:"Event Feed",to:e(i).events()},null,8,["to"]),t(e(l),{title:"Notifications",to:e(i).notifications()},null,8,["to"]),t(e(l),{title:"Concurrency",to:e(i).concurrencyLimits()},null,8,["to"])]),_:1})}}});async function Se(){const a=await de.get("apiUrl"),s={baseUrl:a};return a.startsWith("/")&&H()==="development"&&(s.baseUrl=`http://127.0.0.1:4200${a}`),{config:s}}function Me(){const a=Y(fe.getFeatureFlags,[]),s=x(()=>[...Z,...a.response??[]]),u=G(s),r=x(()=>a.loading);return{can:u,pending:r}}function Pe(){const a=S(!1);function s(){a.value=!a.value}function u(){a.value=!0}function r(){a.value=!1}return{mobileMenuOpen:a,open:u,close:r,toggle:s}}const xe={class:"app-router-view"},Ee=D({__name:"AppRouterView",async setup(a){let s,u;const{can:r}=Me(),{config:g}=([s,u]=X(()=>Se()),s=await s,u(),s),m=_e(g),k=ce();C(pe,r),C(ie,r),C(ve,m),C(re,m),C(ue,k),m.admin.authCheck().then(p=>{p==401?A.currentRoute.value.name!=="login"&&(j("Authentication failed.","error",{timeout:!1}),A.push({name:"login",query:{redirect:A.currentRoute.value.fullPath}})):m.health.isHealthy().then(P=>{P||j(`Can't connect to Server API at ${g.baseUrl}. Check that it's accessible from your machine.`,"error",{timeout:!1})})});const{mobileMenuOpen:d,toggle:f,close:w}=Pe(),n=x(()=>E.lg||d.value);return ee(()=>document.body.classList.toggle("body-scrolling-disabled",n.value&&!E.lg)),(p,P)=>{const U=c("router-link"),$=c("p-button");return _(),T("div",xe,[!e(E).lg&&!p.$route.meta.public?(_(),v(e(ne),{key:0,class:"app-router-view__mobile-menu"},{"upper-links":o(()=>[t(U,{to:e(i).root()},{default:o(()=>[t(e(oe),{icon:"Prefect",class:"app-router-view__prefect-icon"})]),_:1},8,["to"])]),"bottom-links":o(()=>[t($,{small:"",icon:"Bars3Icon",class:"app-router-view__menu-icon",onClick:e(f)},null,8,["onClick"])]),_:1})):y("",!0),n.value&&!p.$route.meta.public?(_(),v(Ce,{key:1,class:"app-router-view__sidebar",onClick:e(w)},null,8,["onClick"])):y("",!0),t(e(le),{class:te(["app-router-view__view",{"app-router-view__view--public":p.$route.meta.public}])},{default:o(({Component:J})=>[t(se,{name:"app-router-view-fade",mode:"out-in"},{default:o(()=>[(_(),v(ae(J)))]),_:2},1024)]),_:1},8,["class"])])}}});export{Ee as default};
//# sourceMappingURL=AppRouterView-YUn4D5iS.js.map
