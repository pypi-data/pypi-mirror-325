import{s as S,l as d,i as h,d as I,p as v,j as R,q as V,n as q}from"../chunks/scheduler.Dg_Xn4WQ.js";import{S as U,i as $,t as p,a as f,c as N,g as O,b as T,d as y,m as W,e as B}from"../chunks/index.gNonUo3Z.js";import{g as P}from"../chunks/entry.RLaQsWRp.js";import{c as C,g as D}from"../chunks/index.C54kKM6_.js";import{T as J}from"../chunks/ToolkitEditor.CHz_xrdC.js";import{a as k,t as M}from"../chunks/index.KoZSVF7z.js";import{e as Q,c as j}from"../chunks/index.SqeRltsp.js";import{t as w}from"../chunks/Toaster.svelte_svelte_type_style_lang.CM0nbnqF.js";function E(l){var i;let n=(i=l[2])==null?void 0:i.content,r,e,o=b(l);return{c(){o.c(),r=d()},l(s){o.l(s),r=d()},m(s,t){o.m(s,t),h(s,r,t),e=!0},p(s,t){var c;t&4&&S(n,n=(c=s[2])==null?void 0:c.content)?(O(),f(o,1,1,q),N(),o=b(s),o.c(),p(o,1),o.m(r.parentNode,r)):o.p(s,t)},i(s){e||(p(o),e=!0)},o(s){f(o),e=!1},d(s){s&&I(r),o.d(s)}}}function b(l){var e,o,i,s;let n,r;return n=new J({props:{id:((e=l[2])==null?void 0:e.id)??"",name:((o=l[2])==null?void 0:o.name)??"",meta:((i=l[2])==null?void 0:i.meta)??{description:""},content:((s=l[2])==null?void 0:s.content)??"",access_control:null,clone:l[1]}}),n.$on("save",l[5]),{c(){T(n.$$.fragment)},l(t){y(n.$$.fragment,t)},m(t,c){W(n,t,c),r=!0},p(t,c){var a,m,g,_;const u={};c&4&&(u.id=((a=t[2])==null?void 0:a.id)??""),c&4&&(u.name=((m=t[2])==null?void 0:m.name)??""),c&4&&(u.meta=((g=t[2])==null?void 0:g.meta)??{description:""}),c&4&&(u.content=((_=t[2])==null?void 0:_.content)??""),c&2&&(u.clone=t[1]),n.$set(u)},i(t){r||(p(n.$$.fragment,t),r=!0)},o(t){f(n.$$.fragment,t),r=!1},d(t){B(n,t)}}}function F(l){let n,r,e=l[0]&&E(l);return{c(){e&&e.c(),n=d()},l(o){e&&e.l(o),n=d()},m(o,i){e&&e.m(o,i),h(o,n,i),r=!0},p(o,[i]){o[0]?e?(e.p(o,i),i&1&&p(e,1)):(e=E(o),e.c(),p(e,1),e.m(n.parentNode,n)):e&&(O(),f(e,1,1,()=>{e=null}),N())},i(o){r||(p(e),r=!0)},o(o){f(e),r=!1},d(o){o&&I(n),e&&e.d(o)}}}function H(l,n,r){let e;const o=v("i18n");R(l,o,a=>r(6,e=a));let i=!1,s=!1,t=null;const c=async a=>{console.log(a);const m=Q(a.content);if(j((m==null?void 0:m.required_open_webui_version)??"0.0.0",k)){console.log("Version is lower than required"),w.error(e.t("Open WebUI version (v{{OPEN_WEBUI_VERSION}}) is lower than required version (v{{REQUIRED_VERSION}})",{OPEN_WEBUI_VERSION:k,REQUIRED_VERSION:(m==null?void 0:m.required_open_webui_version)??"0.0.0"}));return}await C(localStorage.token,{id:a.id,name:a.name,meta:a.meta,content:a.content,access_control:a.access_control}).catch(_=>(w.error(`${_}`),null))&&(w.success(e.t("Tool created successfully")),M.set(await D(localStorage.token)),await P("/workspace/tools"))};return V(()=>{window.addEventListener("message",async a=>{["https://openwebui.com","https://www.openwebui.com","http://localhost:9999"].includes(a.origin)&&(r(2,t=JSON.parse(a.data)),console.log(t))}),(window.opener??!1)&&window.opener.postMessage("loaded","*"),sessionStorage.tool&&(r(2,t=JSON.parse(sessionStorage.tool)),sessionStorage.removeItem("tool"),console.log(t),r(1,s=!0)),r(0,i=!0)}),[i,s,t,o,c,a=>{c(a.detail)}]}class x extends U{constructor(n){super(),$(this,n,H,F,S,{})}}export{x as component};
//# sourceMappingURL=31.CsopEs3o.js.map
