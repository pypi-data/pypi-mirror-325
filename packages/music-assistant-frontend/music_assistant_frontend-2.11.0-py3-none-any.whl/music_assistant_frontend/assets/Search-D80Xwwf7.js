import{x as T,r as v,w as y,o as I,H as t,b as A,y as i,D as g,n as d,A as w,I as C,G as a,F as V,E as L,z as n,M as o,K as m}from"./index-Dvn4b3kE.js";import{H as c}from"./HomeWidgetRow-CCYIPnQ5.js";import{I as B}from"./ItemsListing-BxIggw9V.js";import{C as O}from"./Container-DWavih6c.js";import{T as R}from"./Toolbar-XsObLWPI.js";import{V as $}from"./VTextField-CNfw_aKz.js";import{a as D,b as U}from"./VChip-BKGA7XXZ.js";import{C as F}from"./VListItem-XlHdRn90.js";import"./PanelviewItemCompact-CceVDOrI.js";import"./ItemContextMenu.vue_vue_type_style_index_0_scoped_3a9a25e3_lang-C3noc3qK.js";import"./ProviderIcon.vue_vue_type_style_index_0_lang-CxRRSRNY.js";import"./VList-BFxH2oe3.js";import"./VMenu-BxZEtUbH.js";import"./VCard-DDEjK8sh.js";import"./VCardText-CXkKR7ML.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./eventbus-CGRXT3Tn.js";import"./VCheckbox-DXoKCkvo.js";import"./VCheckboxBtn-B2R62I44.js";import"./VToolbar-Bi9Fkevh.js";import"./VAlert-BKHMgC3s.js";import"./ListItem-CqruFv9t.js";import"./VSpacer-BpjLI35r.js";/* empty css              */import"./VInfiniteScroll-DgELJAW0.js";import"./layout-BesXh2w9.js";import"./VRow-PHUs5bQJ.js";import"./VVirtualScroll-DezxvIhI.js";import"./VContainer-C3X0IHcx.js";const K={key:1},M={key:2},ve=T({__name:"Search",setup(P){const p=v(!1),e=v(),s=v(!1),b=v();y(()=>t.globalSearchTerm,()=>{clearTimeout(b.value),b.value=setTimeout(()=>{f(t.globalSearchTerm,t.globalSearchType)},1e3)},{immediate:!0}),y(()=>t.globalSearchType,()=>{f(t.globalSearchTerm,t.globalSearchType)});const f=async function(l,u){s.value=!0,localStorage.setItem("globalsearch",l||"");const r=t.globalSearchType?50:8,S=u?[u]:void 0;l?e.value=await C.search(l,S,r):e.value=void 0,s.value=!1};I(()=>{if(!t.globalSearchTerm){const l=localStorage.getItem("globalsearch");l&&l!=="null"&&(t.globalSearchTerm=l)}});const h=function(l){!p.value&&l.key=="Backspace"&&t.globalSearchTerm?t.globalSearchTerm=t.globalSearchTerm.slice(0,-1):!p.value&&l.key.length==1&&(t.globalSearchTerm+=l.key)};document.addEventListener("keyup",h),A(()=>{document.removeEventListener("keyup",h)});const k=function(l){return e.value?l==o.TRACK?e.value.tracks:l==o.ARTIST?e.value.artists:l==o.ALBUM?e.value.albums:l==o.PLAYLIST?e.value.playlists:l==o.PODCAST?e.value.podcasts:l==o.AUDIOBOOK?e.value.audiobooks:l==o.RADIO?e.value.radio:[]:[]};return(l,u)=>(i(),g("section",null,[d(R,{icon:"mdi-magnify",title:l.$t("global_search")},null,8,["title"]),d(O,{variant:"default"},{default:w(()=>[d($,{id:"searchInput",modelValue:a(t).globalSearchTerm,"onUpdate:modelValue":u[0]||(u[0]=r=>a(t).globalSearchTerm=r),clearable:"","prepend-inner-icon":"mdi-magnify",label:l.$t("type_to_search"),"hide-details":"",variant:"outlined",onFocus:u[1]||(u[1]=r=>p.value=!0),onBlur:u[2]||(u[2]=r=>p.value=!1)},null,8,["modelValue","label"]),d(D,{modelValue:a(t).globalSearchType,"onUpdate:modelValue":u[3]||(u[3]=r=>a(t).globalSearchType=r),style:{"margin-top":"10px","margin-left":"10px"}},{default:w(()=>[(i(!0),g(V,null,L([void 0,a(o).TRACK,a(o).ARTIST,a(o).ALBUM,a(o).PLAYLIST,a(o).PODCAST,a(o).AUDIOBOOK,a(o).RADIO],r=>(i(),n(U,{key:r,text:l.$t(r?r+"s":"searchtype_all"),value:r},null,8,["text","value"]))),128))]),_:1},8,["modelValue"]),s.value?(i(),n(F,{key:0,color:"primary",indeterminate:"",title:l.$t("tooltip.loading")},null,8,["title"])):m("",!0),a(t).globalSearchType?s.value?m("",!0):(i(),g("div",M,[d(B,{itemtype:`${a(t).globalSearchType}s`,"show-provider":!0,"show-favorites-only-filter":!1,"show-select-button":!1,"show-refresh-button":!1,"load-items":async r=>k(a(t).globalSearchType),title:l.$t(`${a(t).globalSearchType}s`),"allow-key-hooks":!1,"show-search-button":!1,"infinite-scroll":!0,"sort-keys":[],style:{padding:"0"}},null,8,["itemtype","load-items","title"])])):(i(),g("div",K,[e.value&&!s.value?(i(),n(c,{key:0,"widget-row":{label:"tracks",icon:"mdi-file-music",items:e.value.tracks,count:e.value.tracks.length}},null,8,["widget-row"])):m("",!0),e.value&&!s.value?(i(),n(c,{key:1,"widget-row":{label:"artists",icon:"mdi-account-music",items:e.value.artists,count:e.value.artists.length}},null,8,["widget-row"])):m("",!0),e.value&&!s.value?(i(),n(c,{key:2,"widget-row":{label:"albums",icon:"mdi-album",items:e.value.albums,count:e.value.albums.length}},null,8,["widget-row"])):m("",!0),e.value&&!s.value?(i(),n(c,{key:3,"widget-row":{label:"playlists",icon:"mdi-playlist-music",items:e.value.playlists,count:e.value.playlists.length}},null,8,["widget-row"])):m("",!0),e.value&&!s.value?(i(),n(c,{key:4,"widget-row":{label:"podcasts",icon:"mdi-podcast",items:e.value.podcasts,count:e.value.podcasts.length}},null,8,["widget-row"])):m("",!0),e.value&&!s.value?(i(),n(c,{key:5,"widget-row":{label:"audiobooks",icon:"mdi-book-play-outline",items:e.value.audiobooks,count:e.value.audiobooks.length}},null,8,["widget-row"])):m("",!0),e.value&&!s.value?(i(),n(c,{key:6,"widget-row":{label:"radios",icon:"mdi-radio",items:e.value.radio,count:e.value.radio.length}},null,8,["widget-row"])):m("",!0)]))]),_:1})]))}});export{ve as default};
