import{p as Ue,f as je,g as ge,i as qe,n as h,x as Z,y as s,z as m,q as re,G as d,I as oe,a2 as N,af as Ie,c as Q,aE as E,A as r,D as k,M as $,B as K,J as p,aF as Se,S as B,K as f,aC as Be,al as J,aG as We,R as z,am as q,X as j,U as Je,ab as Qe,aa as Ze,H as I,Y as xe,r as F,b as pe,w as H,o as et,v as fe,aA as tt,aH as at,F as ve,E as ye,aw as he}from"./index-Dvn4b3kE.js";import{M as _e,V as se,j as $e,c as U,s as lt}from"./ItemContextMenu.vue_vue_type_style_index_0_scoped_3a9a25e3_lang-C3noc3qK.js";import{_ as it}from"./ProviderIcon.vue_vue_type_style_index_0_lang-CxRRSRNY.js";import{B as Ae,L as ot}from"./ListItem-CqruFv9t.js";import{V as Ce}from"./VCheckbox-DXoKCkvo.js";import{a as st,p as nt,d as rt,r as ut,z as mt,A as dt,w as P,V as ct,D as pt,E as W,k as ft,v as ne}from"./VListItem-XlHdRn90.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as vt,a as yt}from"./VCard-DDEjK8sh.js";import{e as ht}from"./VMenu-BxZEtUbH.js";import{V as bt}from"./VSpacer-BpjLI35r.js";import{V as kt,P as wt}from"./PanelviewItemCompact-CceVDOrI.js";import{C as gt}from"./Container-DWavih6c.js";import{T as It}from"./Toolbar-XsObLWPI.js";import{V as St}from"./VTextField-CNfw_aKz.js";import{V as Bt}from"./VList-BFxH2oe3.js";import{a as _t,V as $t}from"./VInfiniteScroll-DgELJAW0.js";import{V as be,a as ke}from"./VRow-PHUs5bQJ.js";import{V as At}from"./VVirtualScroll-DezxvIhI.js";import{V as we}from"./VAlert-BKHMgC3s.js";const Fe=Symbol.for("vuetify:v-item-group"),Ct=Ue({...st(),...nt({selectedClass:"v-item--selected"}),...rt(),...je()},"VItemGroup"),Te=ge()({name:"VItemGroup",props:Ct(),emits:{"update:modelValue":_=>!0},setup(_,a){let{slots:b}=a;const{themeClasses:g}=qe(_),{isSelected:i,select:w,next:A,prev:T,selected:e}=ut(_,Fe);return()=>h(_.tag,{class:["v-item-group",g.value,_.class],style:_.style},{default:()=>{var v;return[(v=b.default)==null?void 0:v.call(b,{isSelected:i,select:w,next:A,prev:T,selected:e.value})]}})}}),L=ge()({name:"VItem",props:mt(),emits:{"group:selected":_=>!0},setup(_,a){let{slots:b}=a;const{isSelected:g,select:i,toggle:w,selectedClass:A,value:T,disabled:e}=dt(_,Fe);return()=>{var v;return(v=b.default)==null?void 0:v.call(b,{isSelected:g.value,selectedClass:A.value,select:i,toggle:w,value:T.value,disabled:e.value})}}}),Ve=Z({__name:"FavoriteButton",props:{item:{}},setup(_){const a=_;return(b,g)=>{var i;return s(),m(Ae,re(a,{variant:"list",icon:(i=b.item)!=null&&i.favorite?"mdi-heart":"mdi-heart-outline",title:b.$t("tooltip.favorite"),onClick:[g[0]||(g[0]=w=>d(oe).toggleFavorite(b.item)),g[1]||(g[1]=N(()=>{},["prevent"])),g[2]||(g[2]=N(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),Ft={key:0,class:"media-thumb listitem-media-thumb"},Tt={key:1,class:"media-thumb listitem-media-thumb"},Vt={key:0},Ot={key:1},Dt={key:0},Pt={key:0,class:"line-clamp-1"},Lt={key:1},Mt={key:0},Rt={key:1},Kt={key:2},Et={key:3},Nt={key:4},Yt={key:0},Xt={key:1},zt={key:2},Gt={key:3},Ht={key:5},Ut={key:4},jt={key:5},qt={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},Wt=Z({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean}},emits:["menu","click","select"],setup(_,{emit:a}){const{t:b}=Ie(),g=_,i=Q(()=>{if(!("provider_mappings"in g.item))return"";for(const e of g.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[E.DSF,E.FLAC,E.AIFF,E.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),w=a,A=function(e){const v="clientX"in e?e.clientX:e.touches[0].clientX,y="clientY"in e?e.clientY:e.touches[0].clientY;w("menu",g.item,v,y)},T=function(e){g.showCheckboxes||w("click",g.item,e.clientX,e.clientY)};return(e,v)=>(s(),m(ot,{link:"","show-menu-btn":e.showMenu,class:j({unavailable:!e.isAvailable}),onClick:N(T,["stop"]),onMenu:N(A,["stop"])},{prepend:r(()=>[e.showCheckboxes?(s(),k("div",Ft,[h(Ce,{"model-value":e.isSelected,onClick:v[0]||(v[0]=N(()=>{},["stop"])),"onUpdate:modelValue":v[1]||(v[1]=y=>{y!=null&&w("select",e.item,y)})},null,8,["model-value"])])):(s(),k("div",Tt,[h(_e,{size:"50",item:e.isAvailable?e.item:void 0},null,8,["item"])]))]),title:r(()=>[e.item.media_type==d($).FOLDER?(s(),k("span",Vt,[K("span",null,p(d(Se)(e.item,d(b))),1)])):(s(),k("span",Ot,[B(p(e.item.name)+" ",1),"version"in e.item&&e.item.version?(s(),k("span",Dt,"("+p(e.item.version)+")",1)):f("",!0)])),e.item&&e.item.metadata?(s(),m(d(se),{key:2,location:"bottom"},{activator:r(({props:y})=>[d(Be)(e.item.metadata.explicit||!1)?(s(),m(P,re({key:0},y,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):f("",!0)]),default:r(()=>[K("span",null,p(e.$t("tooltip.explicit")),1)]),_:1})):f("",!0)]),subtitle:r(()=>{var y;return[e.item.media_type==d($).TRACK&&"provider_mappings"in e.item?(s(),k("div",Pt,[h(Te,null,{default:r(()=>["artists"in e.item?(s(),m(L,{key:0},{default:r(()=>[B(p(d(J)(e.item.artists,2)),1)]),_:1})):f("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(s(),m(L,{key:1},{default:r(()=>[B(" • "+p(e.item.album.name),1)]),_:1})):f("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(s(),m(L,{key:2},{default:r(()=>[h(P,{style:{"margin-left":"5px"},icon:"md:album"}),B(" "+p(e.item.disc_number),1)]),_:1})):f("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(s(),m(L,{key:3},{default:r(()=>[h(P,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),B(" "+p(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(s(),m(L,{key:4},{default:r(()=>[h(P,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),B(" "+p(e.item.position),1)]),_:1})):f("",!0)]),_:1})])):e.item.media_type==d($).ALBUM&&"year"in e.item?(s(),k("div",Lt,[e.item.album_type!=d(We).UNKNOWN?(s(),k("span",Mt,p(e.$t("album_type."+e.item.album_type))+" • ",1)):f("",!0),K("span",null,p(d(J)(e.item.artists)),1),e.item.year?(s(),k("span",Rt," • "+p(e.item.year),1)):f("",!0)])):"artists"in e.item&&e.item.artists?(s(),k("div",Kt,p(d(J)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(s(),k("div",Et,p(e.item.owner),1)):"metadata"in e.item&&((y=e.item.metadata)!=null&&y.description)?(s(),k("div",Nt,[d(z)("bp6")?(s(),k("span",Yt,p(d(q)(e.item.metadata.description,300)),1)):d(z)("bp4")?(s(),k("span",Xt,p(d(q)(e.item.metadata.description,200)),1)):d(z)("bp3")?(s(),k("span",zt,p(d(q)(e.item.metadata.description,150)),1)):(s(),k("span",Gt,p(d(q)(e.item.metadata.description,80)),1))])):"media_type"in e.item&&!e.item.provider_mappings?(s(),k("div",Ht,p(e.$t(e.item.media_type)),1)):f("",!0)]}),append:r(()=>[i.value?(s(),m(ct,{key:0,src:d($e),width:"30",class:j(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:r(()=>[h(d(se),{activator:"parent",location:"bottom"},{default:r(()=>[B(p(i.value),1)]),_:1})]),_:1},8,["src","class"])):f("",!0),d(z)("bp2")&&e.showProvider?(s(),m(it,{key:1,domain:e.item.media_type==d($).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):f("",!0),"fully_played"in e.item&&e.item.fully_played?(s(),m(P,{key:2,title:e.$t("item_fully_played")},{default:r(()=>v[2]||(v[2]=[B("mdi-check")])),_:1},8,["title"])):"resume_position_ms"in e.item&&e.item.resume_position_ms?(s(),m(P,{key:3,title:e.$t("item_in_progress")},{default:r(()=>v[3]||(v[3]=[B("mdi-clock-fast")])),_:1},8,["title"])):f("",!0),d(z)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(s(),k("div",Ut,[h(Ve,{item:e.item},null,8,["item"])])):f("",!0),e.showDuration&&"duration"in e.item&&e.item.duration&&d(z)("bp0")?(s(),k("div",jt,[K("div",null,[K("span",qt,p(d(Je)(e.item.duration)),1)])])):f("",!0)]),_:1},8,["show-menu-btn","class"]))}}),Jt=ue(Wt,[["__scopeId","data-v-4a51bdc5"]]),Qt={key:0},Zt={key:1},xt={key:2},ea=["src"],ta={key:0},aa=Z({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0}},emits:["menu","click","play","select"],setup(_,{emit:a}){const b=_,g=Q(()=>{for(const e of b.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[E.DSF,E.FLAC,E.AIFF,E.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),i=a,w=function(e){if(b.showCheckboxes)return;const v="clientX"in e?e.clientX:e.touches[0].clientX,y="clientY"in e?e.clientY:e.touches[0].clientY;i("menu",b.item,v,y)},A=function(e){if(b.showCheckboxes){i("select",b.item,!b.isSelected);return}i("click",b.item,e.clientX,e.clientY)},T=function(e){b.showCheckboxes||i("play",b.item,e.clientX,e.clientY)};return(e,v)=>{const y=Qe("hold");return s(),m(kt,null,{default:r(({isHovering:C,props:M})=>[Ze((s(),m(vt,re(M,{tile:"",hover:"",class:["panel-item",{unavailable:!e.isAvailable}],onClick:A,onContextmenu:N(w,["right","prevent"])}),{default:r(()=>[e.showCheckboxes?(s(),m(ht,{key:0,"model-value":e.showCheckboxes,contained:"",scrim:e.isSelected?e.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:r(()=>[h(Ce,{class:"panel-item-checkbox",ripple:!1,"model-value":e.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):f("",!0),h(_e,{item:e.isAvailable?e.item:void 0,style:{height:"auto"}},null,8,["item"]),h(ft,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:r(()=>[h(pt,null,{default:r(()=>[e.item.media_type==d($).FOLDER?(s(),k("span",Qt,[K("span",null,p(d(Se)(e.item,e.$t)),1)])):(s(),k("span",Zt,p(e.item.name),1)),"version"in e.item&&e.item.version?(s(),k("span",xt," - "+p(e.item.version),1)):f("",!0)]),_:1}),"artists"in e.item&&e.item.artists?(s(),m(W,{key:0,class:"line-clamp-1"},{default:r(()=>[B(p(d(J)(e.item.artists,1)),1)]),_:1})):"owner"in e.item&&e.item.owner?(s(),m(W,{key:1,class:"line-clamp-1"},{default:r(()=>[B(p(e.item.owner),1)]),_:1})):e.showMediaType?(s(),m(W,{key:2,class:"line-clamp-1"},{default:r(()=>[B(p(e.$t(e.item.media_type)),1)]),_:1})):(s(),m(W,{key:3,class:"line-clamp-1"}))]),_:1}),(C||d(I).isTouchscreen)&&e.isAvailable?(s(),m(ne,{key:1,icon:"mdi-play",color:"primary",fab:"",style:xe(`position: absolute; right: 15px; bottom: ${e.showActions?90:35}px; opacity: 0.8`),onClick:N(T,["stop"])},null,8,["style"])):f("",!0),e.showActions?(s(),m(yt,{key:2,class:"panel-item-actions"},{default:r(()=>[h(Te,{style:{padding:"0"}},{default:r(()=>[d(Be)(e.item.metadata.explicit||!1)?(s(),m(L,{key:0},{default:r(()=>[h(P,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):f("",!0),g.value?(s(),m(L,{key:1},{default:r(()=>[h(P,{class:j(e.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:r(()=>[K("img",{src:d($e),width:"30"},null,8,ea),h(se,{activator:"parent",location:"bottom"},{default:r(()=>[B(p(g.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):f("",!0),"track_number"in e.item&&e.item.track_number?(s(),m(L,{key:2},{default:r(()=>[h(P,{size:"small",icon:"mdi-music-circle-outline"}),e.item.disc_number?(s(),k("span",ta,p(e.item.disc_number)+"/",1)):f("",!0),B(p(e.item.track_number),1)]),_:1})):"position"in e.item&&e.item.position?(s(),m(L,{key:3},{default:r(()=>[h(P,{size:"small",icon:"mdi-music-circle-outline"}),B(" "+p(e.item.position),1)]),_:1})):f("",!0),d(z)("bp3")?(s(),m(L,{key:4},{default:r(()=>[h(Ve,{item:e.item},null,8,["item"])]),_:1})):f("",!0)]),_:1}),h(bt),C||e.$vuetify.display.mobile?(s(),m(Ae,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:v[0]||(v[0]=N(V=>e.$emit("menu",e.item,V.clientX,V.clientY),["stop"]))})):f("",!0)]),_:2},1024)):f("",!0)]),_:2},1040,["class"])),[[y,w]])]),_:1})}}}),la=ue(aa,[["__scopeId","data-v-ae37b069"]]),ia={key:0},oa={key:1},sa=Z({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(oe.providers).length>1},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1}},setup(_){const a=_,b=tt(),{t:g}=Ie(),i=F({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),w=F("list"),A=F(!1),T=F(!1),e=F([]),v=F([]),y=F(!1),C=F([]),M=F(!1),V=F(!1),Y=F(!0),R=F(!1),G=F(!1),x=F(!1),Oe=function(){A.value?A.value=!1:(A.value=!0,fe(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()}))},ee=function(){Y.value=!Y.value;const t=`${a.path}.${a.itemtype}`;localStorage.setItem(`expand.${t}`,Y.value.toString())},te=function(t){w.value=t;const l=`${a.path}.${a.itemtype}`;localStorage.setItem(`viewMode.${l}`,t)},De=function(){i.value.favoritesOnly=!i.value.favoritesOnly;const t=i.value.favoritesOnly?"true":"false",l=`${a.path}.${a.itemtype}`;localStorage.setItem(`favoriteFilter.${l}`,t),D(void 0,void 0,!0)},Pe=function(){i.value.libraryOnly=!i.value.libraryOnly;const t=i.value.libraryOnly?"true":"false",l=`${a.path}.${a.itemtype}`;localStorage.setItem(`libraryFilter.${l}`,t),D(!0,void 0,!0)},Le=function(){i.value.albumArtistsFilter=!i.value.albumArtistsFilter;const t=i.value.albumArtistsFilter?"true":"false",l=`${a.path}.${a.itemtype}`;localStorage.setItem(`albumArtistsFilter.${l}`,t),D(void 0,void 0,!0)},ae=function(t){return C.value.includes(t)},le=function(t,l){if(l)C.value.includes(t)||C.value.push(t);else for(let o=0;o<C.value.length;o++)C.value[o]===t&&C.value.splice(o,1)},Me=function(){V.value&&(C.value=[]),V.value=!V.value},Re=function(){D(!0,!0)},X=function(t,l,o){const c=Array.isArray(t)?t:[t];c[0].media_type!=$.FOLDER&&lt(c,a.parentItem,l,o)},ie=function(t,l,o){if(!U(t)){X(t,l,o);return}t.media_type==$.FOLDER?b.push({name:"browse",query:{path:t.path}}):w.value=="list"&&[$.TRACK,$.PODCAST_EPISODE].includes(t.media_type)&&a.parentItem?X(t,l,o):b.push({name:t.media_type,params:{itemId:t.item_id,provider:t.provider}})},me=function(t,l,o){if(!U(t)){X(t,l,o);return}if(!I.activePlayerId){I.showPlayersMenu=!0;return}oe.playMedia(t.uri,void 0)},Ke=function(){i.value.search="",A.value=!1,D(void 0,void 0,!0)},Ee=function(t){t!==void 0&&(i.value.sortBy=t);const l=`${a.path}.${a.itemtype}`;localStorage.setItem(`sortBy.${l}`,i.value.sortBy),D(void 0,void 0,!0)},Ne=function(t){var o,c;(o=i.value.albumType)!=null&&o.includes(t)?i.value.albumType=(c=i.value.albumType)==null?void 0:c.filter(S=>S!==t):(i.value.albumType=i.value.albumType||[],i.value.albumType.push(t));const l=`${a.path}.${a.itemtype}`;localStorage.setItem(`albumType.${l}`,i.value.albumType.join(",")),D(void 0,void 0,!0)},Ye=function(){I.globalSearchTerm=i.value.search,a.itemtype=="artists"?I.globalSearchType=$.ARTIST:a.itemtype=="albums"?I.globalSearchType=$.ALBUM:a.itemtype=="tracks"?I.globalSearchType=$.TRACK:a.itemtype=="playlists"?I.globalSearchType=$.PLAYLIST:a.itemtype=="audiobooks"?I.globalSearchType=$.AUDIOBOOK:a.itemtype=="podcasts"?I.globalSearchType=$.PODCAST:a.itemtype=="radios"&&(I.globalSearchType=$.RADIO),b.push({name:"search"})},Xe=function({done:t}){if(R.value){t("empty");return}D(void 0,void 0,void 0,i.value.offset+a.limit).then(()=>{t("ok")})},de=Q(()=>{var t=!1;return i.value.search&&i.value.search.length!==0&&(t=!0),t}),ze=Q(()=>{var l,o;if(a.allowCollapse===!0&&!Y.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:ee,overflowAllowed:!1}];const t=[];return a.showSelectButton!==!1&&t.push({label:"tooltip.select_items",icon:V.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:Me,active:V.value}),a.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Pe,active:i.value.libraryOnly}),a.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:i.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:De,active:i.value.favoritesOnly}),a.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:i.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:Le,active:i.value.albumArtistsFilter}),a.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:y.value,subItems:["album","single","ep","compilation","unknown"].map(c=>{var S;return{label:`album_type.${c}`,selected:(S=i.value.albumType)==null?void 0:S.includes(c),action:()=>{Ne(c)}}})}),(a.showRefreshButton!==!1||M.value)&&t.push({label:M.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Re,active:M.value,disabled:y.value}),(l=a.sortKeys)!=null&&l.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:a.sortKeys.length<=1||y.value,subItems:a.sortKeys.map(c=>({label:`sort.${c}`,selected:i.value.sortBy==c,action:()=>{Ee(c)}}))}),a.showSearchButton!==!1&&t.push({label:de.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Oe,active:de.value,disabled:y.value}),t.push({label:"tooltip.toggle_view_mode",icon:w.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:w.value=="list",action:()=>{te("list")}},{label:"view.panel",icon:"mdi-grid",selected:w.value=="panel",action:()=>{te("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:w.value=="panel_compact",action:()=>{te("panel_compact")}}]}),(o=a.extraMenuItems)!=null&&o.length&&t.push(...a.extraMenuItems),a.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:ee}),t}),D=async function(t=!1,l=!1,o=!1,c=0){if(!y.value){if(y.value=!0,o&&a.loadPagedData!=null&&(t=!0),(t||l)&&(c=0,R.value&&(x.value=!0),R.value=!1,G.value=!1,M.value=!1),i.value.offset=c,i.value.limit=a.limit,i.value.refresh=l,a.loadPagedData!=null){const S=await a.loadPagedData(i.value);i.value.offset?e.value.push(...S):e.value=S,Math.abs(S.length-a.limit)>10&&(R.value=!0)}else if(a.loadItems!=null){(!G.value||l)&&(v.value=await a.loadItems(i.value),G.value=!0);const S=He(v.value,i.value);i.value.offset?e.value.push(...S):e.value=S,R.value=S.length<a.limit}i.value.refresh=!1,y.value=!1,x.value=!1}},Ge=async function(){const t=`${a.path}.${a.itemtype}`,l=localStorage.getItem(`viewMode.${t}`);l&&l!=="null"?w.value=l:a.itemtype=="artists"||a.itemtype=="albums"?w.value="panel":w.value="list";const o=localStorage.getItem(`sortBy.${t}`);if(o&&o!=="null"&&a.sortKeys.includes(o)?i.value.sortBy=o:i.value.sortBy=a.sortKeys[0],a.showFavoritesOnlyFilter!==!1){const c=localStorage.getItem(`favoriteFilter.${t}`);c&&c=="true"&&(i.value.favoritesOnly=!0)}if(a.showLibraryOnlyFilter!==!1){const c=localStorage.getItem(`libraryFilter.${t}`);c&&c=="true"&&(i.value.libraryOnly=!0)}if(a.showAlbumArtistsOnlyFilter!==!1){const c=localStorage.getItem(`albumArtistsFilter.${t}`);c&&(i.value.albumArtistsFilter=c=="true")}if(a.allowCollapse!==!1){const c=localStorage.getItem(`expand.${t}`);c&&(Y.value=c=="true")}if(a.showAlbumTypeFilter===!0){const c=localStorage.getItem(`albumType.${t}`);c&&(i.value.albumType=c.split(","))}if(a.restoreState){let c=`search.${t}`;a.parentItem&&(c+=a.parentItem.item_id);const S=localStorage.getItem(c);S&&S!=="null"&&(i.value.search=S)}},ce=function(t){I.dialogActive||y.value||(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),C.value=e.value,V.value=!0):!T.value&&t.key=="Backspace"?i.value.search=i.value.search.slice(0,-1):!T.value&&t.key.length==1&&(i.value.search+=t.key,A.value=!0))};a.allowKeyHooks&&(document.addEventListener("keydown",ce),pe(()=>{document.removeEventListener("keydown",ce)})),a.restoreState&&pe(()=>{const t=a.path||a.itemtype,l=document.querySelector("#cont");I.prevState={path:t,scrollPos:(l==null?void 0:l.scrollTop)||0,pagedItems:e.value,allItems:v.value,allItemsReceived:R.value,initialDataReceived:G.value,params:i.value}}),H(()=>i.value.search,t=>{t&&(A.value=!0),D(void 0,void 0,!0);let l=`search.${a.path}.${a.itemtype}`;a.parentItem&&(l+=a.parentItem.item_id),localStorage.setItem(l,i.value.search)}),H(()=>a.path,t=>{y.value!=!0&&(e.value=[],v.value=[],D(!0))}),H(()=>a.parentItem,()=>{y.value!=!0&&(v.value=[],M.value=!0)},{deep:!0}),H(()=>a.limit,t=>{i.value.limit=t}),H(()=>a.updateAvailable,t=>{y.value||(M.value=t)},{immediate:!0}),et(async()=>{var l;Ge();const t=a.path||a.itemtype;a.restoreState&&((l=I.prevState)==null?void 0:l.path)==t?(i.value=I.prevState.params,e.value=I.prevState.pagedItems,v.value=I.prevState.allItems,R.value=I.prevState.allItemsReceived,G.value=I.prevState.initialDataReceived,fe(()=>{const o=document.getElementById("cont");o&&at(o,I.prevState.scrollPos,50)}),y.value=!1):D(!0)});const O=function(t,l=!1){return t?"label"in t&&t.label&&t.name?g(t.label,[t.name]):"label"in t&&t.label?g(t.label):l&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},He=function(t,l){var c,S;let o=[];if(l.search){const u=l.search.toLowerCase();for(const n of t)(n.name.toLowerCase().includes(u)||"artist"in n&&((c=n.artist)!=null&&c.name.toLowerCase().includes(u))||"album"in n&&((S=n.album)!=null&&S.name.toLowerCase().includes(u))||"artists"in n&&n.artists&&n.artists.length&&n.artists[0].name.toLowerCase().includes(u))&&o.push(n)}else o=[...t];return l.sortBy=="name"&&o.sort((u,n)=>O(u).localeCompare(O(n),void 0,{numeric:!0})),l.sortBy=="sort_name"&&o.sort((u,n)=>O(u,!0).localeCompare(O(n,!0),void 0,{numeric:!0})),l.sortBy=="name_desc"&&o.sort((u,n)=>O(n).localeCompare(O(u),void 0,{numeric:!0})),l.sortBy=="sort_name_desc"&&o.sort((u,n)=>O(n,!0).localeCompare(O(u,!0),void 0,{numeric:!0})),l.sortBy=="album"&&o.sort((u,n)=>O(u.album).localeCompare(O(n.album),void 0,{numeric:!0})),l.sortBy=="artist"&&o.sort((u,n)=>O(u.artists[0]).localeCompare(O(n.artists[0]))),l.sortBy=="track_number"&&(o.sort((u,n)=>(u.track_number||0)-(n.track_number||0)),o.sort((u,n)=>(u.disc_number||0)-(n.disc_number||0))),l.sortBy=="position"&&o.sort((u,n)=>(u.position||0)-(n.position||0)),l.sortBy=="position_desc"&&o.sort((u,n)=>(n.position||0)-(u.position||0)),l.sortBy=="year"&&o.sort((u,n)=>(u.year||0)-(n.year||0)),l.sortBy=="year_desc"&&o.sort((u,n)=>(n.year||0)-(u.year||0)),l.sortBy=="recent"&&o.sort((u,n)=>(n.timestamp_added||0)-(u.timestamp_added||0)),l.sortBy=="duration"&&o.sort((u,n)=>(u.duration||0)-(n.duration||0)),l.sortBy=="duration_desc"&&o.sort((u,n)=>(n.duration||0)-(u.duration||0)),l.sortBy=="provider"&&o.sort((u,n)=>u.provider.localeCompare(n.provider)),l.favoritesOnly&&(o=o.filter(u=>u.favorite)),l.albumType&&l.albumType.length>0&&(o=o.filter(u=>{var n;return(n=l.albumType)==null?void 0:n.includes(u.album_type)})),o.slice(l.offset,l.offset+l.limit)};return(t,l)=>t.hideOnEmpty&&e.value.length==0?f("",!0):(s(),k("section",ia,[h(It,{icon:t.icon,title:t.title,count:i.value.search?e.value.length:t.total||v.value.length,color:"transparent","menu-items":ze.value,onTitleClicked:ee},null,8,["icon","title","count","menu-items"]),h(Bt),A.value&&Y.value?(s(),m(St,{key:0,id:"searchInput",modelValue:i.value.search,"onUpdate:modelValue":l[0]||(l[0]=o=>i.value.search=o),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:l[1]||(l[1]=o=>T.value=!0),onBlur:l[2]||(l[2]=o=>T.value=!1),"onClick:clear":Ke},null,8,["modelValue","label"])):f("",!0),Y.value?(s(),m(gt,{key:1,variant:w.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:r(()=>[!x.value&&!(e.value.length==0&&R.value)?(s(),m(_t,{key:0,onLoad:Xe,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:r(()=>[w.value=="panel"?(s(),m(be,{key:0},{default:r(()=>[(s(!0),k(ve,null,ye(e.value,o=>(s(),m(ke,{key:o.uri,cols:"12",class:j(`col-${d(he)(t.$vuetify.display.width)}`)},{default:r(()=>[h(la,{item:o,"is-selected":ae(o),"show-checkboxes":V.value,"show-actions":["tracks","albums"].includes(t.itemtype),"is-available":d(U)(o),onSelect:le,onMenu:X,onClick:ie,onPlay:me},null,8,["item","is-selected","show-checkboxes","show-actions","is-available"])]),_:2},1032,["class"]))),128))]),_:1})):f("",!0),w.value=="panel_compact"?(s(),m(be,{key:1},{default:r(()=>[(s(!0),k(ve,null,ye(e.value,o=>(s(),m(ke,{key:o.uri,cols:"12",class:j(`col-${d(he)(t.$vuetify.display.width)}`)},{default:r(()=>[h(wt,{item:o,"is-selected":ae(o),"show-checkboxes":V.value,"is-available":d(U)(o),onSelect:le,onMenu:X,onClick:ie,onPlay:me},null,8,["item","is-selected","show-checkboxes","is-available"])]),_:2},1032,["class"]))),128))]),_:1})):f("",!0),w.value=="list"?(s(),m(At,{key:2,"item-height":70,height:"100%",items:e.value,style:{height:"100%",overflow:"hidden"}},{default:r(({item:o})=>[h(Jt,{item:o,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":t.showMenu,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":V.value,"is-selected":ae(o),"is-available":d(U)(o),"show-details":t.itemtype.includes("versions"),onSelect:le,onMenu:X,onClick:ie},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","show-details"])]),_:1},8,["items"])):f("",!0)]),_:1},8,["mode","load-more-text"])):f("",!0),!y.value&&e.value.length==0?(s(),k("div",oa,[!y.value&&e.value.length==0&&(i.value.search||i.value.favoritesOnly)?(s(),m(we,{key:0,title:t.$t("no_content_filter")},{default:r(()=>[i.value.search?(s(),m(ne,{key:0,style:{"margin-top":"15px"},onClick:Ye},{default:r(()=>[B(p(t.$t("try_global_search")),1)]),_:1})):f("",!0)]),_:1},8,["title"])):!y.value&&e.value.length==0?(s(),m(we,{key:1},{default:r(()=>[B(p(t.$t("no_content")),1)]),_:1})):f("",!0)])):f("",!0),h($t,{"model-value":C.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:r(()=>[h(ne,{color:"primary",variant:"text",onClick:l[3]||(l[3]=o=>X(C.value,o.clientX,o.clientY))},{default:r(()=>[B(p(t.$t("actions")),1)]),_:1})]),default:r(()=>[K("span",null,p(t.$t("items_selected",[C.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):f("",!0)]))}}),$a=ue(sa,[["__scopeId","data-v-ac2c33ff"]]);export{$a as I};
