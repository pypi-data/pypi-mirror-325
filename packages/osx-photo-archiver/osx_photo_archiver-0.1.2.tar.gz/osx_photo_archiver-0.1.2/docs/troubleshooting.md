# トラブルシューティングガイド

## よくあるエラーと解決方法

### 1. インストール関連の問題

#### 1.1 osxphotosのインストールエラー

**症状**:
```
ERROR: Could not find a version that satisfies the requirement osxphotos
```

**解決方法**:
1. Pythonバージョンの確認
   ```bash
   python3 --version  # 3.8以上であることを確認
   ```
2. pipの更新
   ```bash
   pip install --upgrade pip
   ```
3. 必要に応じてXcodeコマンドラインツールのインストール
   ```bash
   xcode-select --install
   ```

#### 1.2 依存関係のエラー

**症状**:
```
ERROR: Failed building wheel for [パッケージ名]
```

**解決方法**:
1. ビルドツールの確認
   ```bash
   pip install --upgrade wheel setuptools
   ```
2. 仮想環境の再作成
   ```bash
   deactivate  # 既存の仮想環境を無効化
   rm -rf venv
   python3 -m venv venv
   source venv/bin/activate
   pip install -e .
   ```

### 2. 権限関連の問題

#### 2.1 Photosライブラリへのアクセスエラー

**症状**:
```
エラー: Photosライブラリへのアクセス権限がありません
```

**解決方法**:
1. システム環境設定でフルディスクアクセス権限を確認
2. 権限を付与したアプリケーションの再起動
3. 必要に応じてシステムの再起動

#### 2.2 出力先ディレクトリの権限エラー

**症状**:
```
エラー: 出力先ディレクトリへの書き込み権限がありません
```

**解決方法**:
1. ディレクトリ権限の確認
   ```bash
   ls -la [出力先ディレクトリ]
   ```
2. 必要に応じて権限を変更
   ```bash
   chmod u+w [出力先ディレクトリ]
   ```

### 3. 実行時のエラー

#### 3.1 メモリ不足エラー

**症状**:
- プログラムが予期せず終了
- システムが遅くなる

**解決方法**:
1. 一度に処理する期間を短くする
   ```bash
   # 例: 1ヶ月単位で処理
   osx-photo-archiver --from-date 2024-01-01 --to-date 2024-01-31 [出力先]
   ```
2. 他のアプリケーションを終了してメモリを解放

#### 3.2 重複ファイルの問題

**症状**:
```
Warning: 重複ファイルが存在します
```

**解決方法**:
1. `--skip-duplicates`オプションの使用
   ```bash
   osx-photo-archiver --skip-duplicates [出力先]
   ```
2. 既存ファイルの確認と必要に応じたバックアップ

### 4. その他の問題

#### 4.1 日付データの不整合

**症状**:
- 写真が予期しないディレクトリに保存される
- 日付が正しく認識されない

**解決方法**:
1. Photosアプリで写真のメタデータを確認
2. 必要に応じて写真の日付情報を修正

#### 4.2 パフォーマンスの問題

**症状**:
- 処理が極端に遅い
- システムの反応が悪くなる

**解決方法**:
1. 処理する写真の数を制限
2. システムリソースの確認
   ```bash
   top  # または Activity Monitor を使用
   ```
3. ディスク容量の確認
   ```bash
   df -h
   ```

## デバッグ情報の収集

### 1. ログの確認

1. システムログの確認
   ```bash
   console # Console.appを開く
   ```

2. osxphotosのデバッグ情報
   ```bash
   osxphotos list --debug
   ```

### 2. システム情報の確認

```bash
# Python環境
python3 --version
pip list

# OSバージョン
sw_vers

# ディスク容量
df -h
```

## サポートを受ける前に

1. 最新バージョンを使用していることを確認
2. ドキュメントを再確認
3. GitHubのIssuesで類似の問題を検索
4. 以下の情報を準備:
   - エラーメッセージの全文
   - 実行したコマンドとオプション
   - システム情報
   - 再現手順

## 既知の制限事項

1. 大量の写真(10万枚以上)を一度に処理する場合のパフォーマンス
2. 特定のファイル形式での制限
3. macOSのバージョンによる互換性の違い

これらの制限に遭遇した場合は、処理を分割するなどの対策を検討してください。
