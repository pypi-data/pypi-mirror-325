.\" Automatically generated by Pandoc 2.19.2
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "oracle" "1" "" "" "server for the SPHINX password manager"
.hy
.SH NAME
.PP
oracle - server for the SPHINX password manager
.SH SYNOPSIS
.PP
\f[V]oracle [init]\f[R]
.SH DESCRIPTION
.PP
The SPHINX protocol only makes sense if the server (called oracle) is
somewhere else than where you type your password, pwdsphinx comes with a
server implemented in python3 which you can host off-site from your
usual desktop/smartphone.
.PP
The server can be started simply by running \f[V]oracle\f[R] it does not
take any parameters.
.SH CONFIGURATION
.PP
The server can be configured by any of the following files:
.IP \[bu] 2
\f[V]/etc/sphinx/config\f[R]
.IP \[bu] 2
\f[V]\[ti]/.sphinxrc\f[R]
.IP \[bu] 2
\f[V]\[ti]/.config/sphinx/config\f[R]
.IP \[bu] 2
\f[V]./sphinx.cfg\f[R]
.PP
Files are parsed in this order, this means global settings can be
overridden by per-user and per-directory settings.
.PP
The server can be configured by changing the variables in the
\f[V][server]\f[R] section of the config file.
.PP
The \f[V]address\f[R] is the IP address on which the server is
listening, default is \f[V]localhost\f[R] - you might want to change
that.
.PP
The \f[V]port\f[R] where the server is listening is by default 2355.
Another recommended values is to use port 433 which is allowed by most
firewalls while 2355 is not.
.PP
\f[V]ssl_key\f[R] and \f[V]ssl_cert\f[R] must be specified, they point
at a traditional TLS certificate and secret key file.
It is recommended to not use self-signed certs, but to use certs that
signed by CAs that are recognized widely by browsers and other TLS
clients.
.PP
\f[V]datadir\f[R] specifies the data directory where all the device
\[lq]secrets\[rq] are stored, this defaults to \[lq]data/\[rq] in the
current directory.
You might want to back up this directory from time to time to an
encrypted medium.
.PP
\f[V]verbose\f[R] enables logging to standard output.
.PP
\f[V]timeout\f[R] sets the timeout for any connection the server keeps
open.
.PP
\f[V]max_kids\f[R] sets the number maximum requests handled in parallel.
The \f[V]timeout\f[R] config variable makes sure that all handlers are
recycled in predictable time.
.PP
\f[V]rl_decay\f[R] specifies the number of seconds after which a
ratelimit level decays to an easier difficulty.
.PP
\f[V]rl_threshold\f[R] increase the difficulty of ratelimit puzzles if
not decaying.
.PP
\f[V]rl_gracetime\f[R] gracetime in seconds added to the expected time
to solve a rate-limiting puzzle.
.PP
\f[V]ltsigkey\f[R] a path pointing at a long-term signature private key.
This can be generated by running \f[V]oracle init\f[R].
.SH Initializing an oracle
.PP
Given a configuration, the oracle can generate its own long-term
signature key.
To do so, simply run \f[V]oracle init\f[R] and it will store the private
key at the location pointed by the \f[V]ltsigkey\f[R] configuration
value.
This operation will also output the public key, at the same location as
the private key, but with a \f[V].pub\f[R] extension.
Furthermore the public key is also displayed as a Base64 encoded string
on the standard output.
.SH SECURITY CONSIDERATIONS
.PP
The configuration values \f[V]max_kids\f[R] and \f[V]timeout\f[R] can be
used to tune how many requests are served in parallel and how long each
request is allowed to take before it gets killed.
An attacker might be able to run a denial-of-service attack against your
server, by keeping all \f[V]max_kids\f[R] connections
\[lq]occupied\[rq].
.PP
Since the server does only know about failed authorizations for
management operations, but not about correctness of master passwords for
get requests, there is no way to mitigate master password bruteforce
attempts aside from ratelimiting.
By tuning the configuration variables starting with \f[V]rl_\f[R] it is
possible to configure this.
If you have clients that have less than 1G RAM, it might be possible to
increase the difficulty to the maximum level where those devices will
not be able to solve the ratelimting puzzles.
Rate-limiting in general should not be noticeable, only if dozens of get
requests are served to the same record.
At the highest level the solution should take about 20-40 seconds
(depending on your cpu).
.SH REPORTING BUGS
.PP
https://github.com/stef/pwdsphinx/issues/
.SH AUTHOR
.PP
Written by Stefan Marsiske.
.SH COPYRIGHT
.PP
Copyright \[co] 2024 Stefan Marsiske.
License GPLv3+: GNU GPL version 3 or later
<https://gnu.org/licenses/gpl.html>.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
.SH SEE ALSO
.PP
\f[V]sphinx(1)\f[R], \f[V]getpwd(1)\f[R]
